function makeSwiper(){var e={direction:"horizontal",touchMoveStopPropagation:!0,paginationClickable:!0,pagination:".swiper-pagination",iOSEdgeSwipeDetection:!0,flip:{slideShadows:!1},onTransitionEnd:function(e,t){console.log("slide"),httpAnswer()}};return new Swiper(".swiper-container",e)}var app=angular.module("myApp",["ngRoute","ui.router","angular-md5","ngSanitize","ngCookies"]);app.config(function(e,t){t.when("","/basicSituation"),e.state("personal",{url:"/personal",templateUrl:"./html/personal.html",controller:"personalCtrl"}).state("basicSituation",{url:"/basicSituation",templateUrl:"./html/basicSituation.html",controller:"basicSituationCtrl"}).state("medicalHistory",{url:"/medicalHistory",templateUrl:"./html/medicalHistory.html",controller:"medicalHistoryCtrl"}).state("habitsCustoms",{url:"/habitsCustoms",templateUrl:"./html/habitsCustoms.html",controller:"habitsCustomsCtrl"}).state("medication",{url:"/medication",templateUrl:"./html/medication.html",controller:"medicationCtrl"}).state("breast",{url:"/breast",templateUrl:"./html/breast.html",controller:"breastCtrl"}).state("login",{url:"/login",templateUrl:"./html/login.html",controller:"loginCtrl"})});var allFactory={userId:"",teleNum:"",password:"",HASHPASSWD:"",tagIP:"http://10.24.14.92",postRegister:"http://120.27.49.154:8080/BreastCancer/register",postLogin:"http://120.27.49.154:8080/BreastCancer/login",ipAddress:"http://120.27.49.154:8080/BreastCancer/getQuestion",setAnwserAddress:"http://120.27.49.154:8080/BreastCancer/getInsertInfo",isLogin:!1,isRemember:!1},httpAnswer;app.filter("to_trusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),app.directive("repeatFinish",function(){return{link:function(e,t,n){1==e.$last&&(e.rootSwiper=makeSwiper(),console.log("ng-repeat render finish"))}}});var sumWeight=function(e){var t=[];for(var n in e)!e[n].options||"0"!=e[n].questionAnswerType&&"1"!=e[n].questionAnswerType&&"2"!=e[n].questionAnswerType&&"4"!=e[n].questionAnswerType&&"5"!=e[n].questionAnswerType&&"7"!=e[n].questionAnswerType?"3"==e[n].questionAnswerType||"6"==e[n].questionAnswerType?t[n]=2:t[n]=2:t[n]=e[n].options.length+1;return console.log(t),splitWeight(t,e)},splitWeight=function(e,t){var n=0,o=0,s=[];for(var r in e)e[r]+o<=13?o+=e[r]:(o=0,s[n]=r,n+=1);console.log(s);var i=[];for(var l in s)0==l?i[l]=t.slice(0,s[l]):i[l]=t.slice(s[l-1],s[l]),i[s.length]=t.slice(s[s.length-1],s[s.length]);return i},takePagesNum=function(e){var t=$(".swiper-pagination");for(var n in e)t.append('<span class="swiper-pagination-bullet"></span>')};app.controller("personalCtrl",function(e,t,n){console.log("personalCtrl  p1"),$(".icon-gerenxinxi").addClass("active"),t.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50),e.setModOneQue=function(e){console.log(e)},e.aa='足月妊娠次数<input class="insertPut shortInput" type="text" placeholder="请输入">次',e.testDou=[{questionAnswerType:1,questionId:"0.10",questionContent:"居住地区：",questionType:1,options:[{anwserContent:"城市",anwserId:"1"},{anwserContent:"农村",anwserId:"2"}]},{questionAnswerType:1,questionId:"0.15",questionContent:"用户类别：",questionType:1,options:[{anwserContent:"病例组",anwserId:"1"},{anwserContent:"对照组",anwserId:"2"}]},{questionAnswerType:1,questionId:"0.16",questionContent:"填写方式：",questionType:1,options:[{anwserContent:"线上",anwserId:"1"},{anwserContent:"线下",anwserId:"2"}]}],e.testSin=[{questionAnswerType:1,questionId:"0.10",questionContent:"居住地区：",questionType:1,options:[{anwserContent:"城市",anwserId:"1"},{anwserContent:"农村",anwserId:"2"}]},{questionAnswerType:1,questionId:"0.15",questionContent:"用户类别：",questionType:1,options:[{anwserContent:"病例组",anwserId:"1"},{anwserContent:"对照组",anwserId:"2"}]},{questionAnswerType:1,questionId:"0.16",questionContent:"填写方式：",questionType:1,options:[{anwserContent:"线上",anwserId:"1"},{anwserContent:"线下",anwserId:"2"}]}],n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:"1"}).success(function(t){console.log(t),"success"==t.msg&&(e.modOne=sumWeight(_.flatten(t.body.questions)),e.setModOneQue(e.modOne))})}),app.controller("basicSituationCtrl",function(e,t,n,o,s,r,i){console.log("basicSituationCtrl  p2"),$(".icon-xinyongqingkuang-copy").addClass("active"),$(".swiper-slide").height($(window).height()-50),e.alertLogin=function(){swal({title:"登录",allowOutsideClick:!1,showCloseButton:!1,animation:!1,input:"password",inputPlaceholder:"密码(6-10位)",html:'<input class="swal2-input" id="teleNum" placeholder="手机号/用户名" type="text" style="display: block;" autofocus><div class="weui-cell__hd"><input type="checkbox" class="loginCheckbox" name="checkbox1" id="loginCheckbox" checked="checked"><span>记住密码自动登录</span></div>',inputValidator:function(e){return new Promise(function(t,n){$teleNum=$("#teleNum").val(),/^1(3|4|5|7|8)\d{9}$/.test($teleNum)&&e.length>=6&&e.length<=10?t():n(/^1(3|4|5|7|8)\d{9}$/.test($teleNum)?"请正确填写密码!":"请正确填写手机号!")})},showCancelButton:!0,confirmButtonText:"登录",cancelButtonText:"去注册"}).then(function(t){allFactory.teleNum=$("#teleNum").val(),allFactory.password=t,allFactory.HASHPASSWD=i.createHash(t),n.post(allFactory.postLogin,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient",isRemember:allFactory.isRemember}).success(function(t){t.msg?(allFactory.isLogin=!0,allFactory.userId=t.userId,e.getPage(),swal.resetDefaults(),swal({title:"登录成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")}),allFactory.isRemember&&s.put("user",{userId:allFactory.userId,HASHPASSWD:allFactory.HASHPASSWD},{expires:new Date((new Date).getTime()+604800)})):swal("错误",t.errorText,"error").then(function(){e.alertLogin()})})},function(t){"cancel"===t&&e.alertRegister()})["catch"](swal.noop)},e.alertRegister=function(){swal.setDefaults({input:"text",confirmButtonText:"下一步&rarr;",allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,animation:!1,cancelButtonText:"去登录",progressSteps:["1","2","3","4"]});var t,o=[{title:"手机号码",input:"text",inputPlaceholder:"请输入您的真实手机号码",confirmButtonText:"发送验证码",inputValidator:function(e){return new Promise(function(t,n){/^1(3|4|5|7|8)\d{9}$/.test(e)?(allFactory.teleNum=e,t()):n("请输入正确的手机号")})}},{title:"验证码",input:"text",inputPlaceholder:"请填入刚刚收到的验证码"},{title:"密码",input:"password",inputPlaceholder:"密码(6-10位)",inputValidator:function(e){return new Promise(function(n,o){e.length>=6&&e.length<=10?(t=e,n()):o("请按格式正确输入密码")})}},{title:"重复输入密码",input:"password",confirmButtonText:"注册",inputPlaceholder:"重复输入密码(6-10位)",inputValidator:function(o){return new Promise(function(s,r){o.length>=6&&o.length<=10&&o==t?(allFactory.password=t,allFactory.HASHPASSWD=i.createHash(t),n.post(allFactory.postRegister,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient"}).success(function(t){t.msg?(allFactory.userId=t.userId,s(),allFactory.isLogin=!0,e.getPage()):(swal.resetDefaults(),swal("错误",t.errorText,"error").then(function(){e.alertRegister()}))})):r(o!=t?"密码输入不符":"请按格式正确输入密码")})}}];swal.queue(o).then(function(e){swal.resetDefaults(),swal({title:"注册成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")})},function(t){"cancel"===t&&(swal.resetDefaults(),e.alertLogin())})};var l=2;e.userAnswer=[],e.fillBlank=function(t,n){var o={UUID:t,answerId:[n]};if(0!=e.userAnswer.length){var s=!1;_.each(e.userAnswer,function(e){e.UUID==t&&(e.answerId=[n],s=!0)}),s||e.userAnswer.push(o)}else e.userAnswer.push(o);console.log(e.userAnswer)},e.chooseSin=function(t,n){var o={UUID:t,answerId:[n]};if(0!=e.userAnswer.length){var s=!1;_.each(e.userAnswer,function(e){e.UUID==t&&(e.answerId=[n],s=!0)}),s||e.userAnswer.push(o)}else e.userAnswer.push(o);console.log(e.userAnswer)},e.chooseDou=function(t,n){var o={UUID:t,answerId:[n]};if(0!=e.userAnswer.length){var s=!1;_.each(e.userAnswer,function(e){if(e.UUID==t){var o=!1;_.each(e.answerId,function(t,s){t==n&&(e.answerId.splice(s,1),o=!0)}),o||e.answerId.push(n),s=!0}}),s||e.userAnswer.push(o)}else e.userAnswer.push(o);console.log(e.userAnswer)},e.setModTwoQue=function(t){console.log(t),e.setModTwo=t},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:l}).success(function(t){console.log(t),t.msg?(e.modTwo=sumWeight(_.flatten(t.body.questions)),e.setModTwoQue(e.modTwo)):(swal("网络错误，请重试",t.errorText,"error"),e.alertLogin())}).error(function(e,t,n,o){swal("网络错误","错误信息："+t,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:l,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,t,n,o){swal("网络错误","错误信息："+t,"error")})},allFactory.isLogin?e.getPage():e.alertLogin(),e.cookUser=s.get("user"),console.log(e.cookUser)}),app.controller("medicalHistoryCtrl",function(e,t,n){console.log("medicalHistoryCtrl  p3"),$(".icon-bingli").addClass("active"),t.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50)}),app.controller("habitsCustomsCtrl",function(e,t,n){console.log("habitsCustomsCtrl  p4"),$(".icon-shenghuo").addClass("active"),t.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50)}),app.controller("medicationCtrl",function(e,t,n){console.log("medicationCtrl  p5"),$(".icon-yao").addClass("active"),t.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50)}),app.controller("breastCtrl",function(e,t,n){console.log("breastCtrl  p6"),$(".icon-zhishichanquan2").addClass("active"),t.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50)}),app.controller("loginCtrl",function(e,t,n){console.log("222")}),app.directive("changePage",function(){return{restrict:"EA",replace:!0,template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,t){e.prev=function(){t.swiper.slidePrev()},e.next=function(){t.swiper.slideNext()}}}}),app.directive("prevMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"&infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一章</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,t,n){e.prev=function(){n.go(e.pageUrl,{})},e.next=function(){t.swiper.slideNext()}}}}),app.directive("nextMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"@infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一章</button></div>',controller:function(e,t,n){e.prev=function(){t.swiper.slidePrev()},e.next=function(){n.go(e.pageUrl,{})}}}});
//# sourceMappingURL=app.js.map
