function makeSwiper(){var e={direction:"horizontal",touchMoveStopPropagation:!0,paginationClickable:!0,pagination:".swiper-pagination",iOSEdgeSwipeDetection:!0,flip:{slideShadows:!1},onTransitionEnd:function(e,r){console.log("slide"),httpAnswer()}};return new Swiper(".swiper-container",e)}var app=angular.module("myApp",["ngRoute","ui.router","angular-md5","ngSanitize","ngCookies"]);app.config(function(e,r){r.when("","/personal"),e.state("personal",{url:"/personal",templateUrl:"./html/personal.html",controller:"personalCtrl"}).state("basicSituation",{url:"/basicSituation",templateUrl:"./html/basicSituation.html",controller:"basicSituationCtrl"}).state("medicalHistory",{url:"/medicalHistory",templateUrl:"./html/medicalHistory.html",controller:"medicalHistoryCtrl"}).state("habitsCustoms",{url:"/habitsCustoms",templateUrl:"./html/habitsCustoms.html",controller:"habitsCustomsCtrl"}).state("medication",{url:"/medication",templateUrl:"./html/medication.html",controller:"medicationCtrl"}).state("breast",{url:"/breast",templateUrl:"./html/breast.html",controller:"breastCtrl"}).state("login",{url:"/login",templateUrl:"./html/login.html",controller:"loginCtrl"})});var allFactory={userId:"",teleNum:"",password:"",HASHPASSWD:"",tagIP:"http://10.24.14.92",postRegister:"http://120.27.49.154/BreastCancer/register",postLogin:"http://120.27.49.154/BreastCancer/login",ipAddress:"http://120.27.49.154/BreastCancer/getQuestion",setAnwserAddress:"http://120.27.49.154/BreastCancer/getInsertInfo",isLogin:!1,isRemember:!0};app.directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(r,s,n){r.$watch(function(){return r.$eval(n.bindHtmlCompile)},function(n){s.html(n),e(s.contents())(r)})}}}]);var httpAnswer;app.filter("to_trusted",["$sce",function(e){return function(r){return e.trustAsHtml(r)}}]),app.directive("repeatFinish",function(){return{link:function(e,r,s){1==e.$last&&(e.rootSwiper=makeSwiper(),console.log("ng-repeat render finish"))}}});var sumWeight=function(e){for(var r=[],s=0;s<e.length;s++)!e[s].options||"0"!=e[s].questionAnswerType&&"1"!=e[s].questionAnswerType&&"2"!=e[s].questionAnswerType&&"4"!=e[s].questionAnswerType&&"5"!=e[s].questionAnswerType&&"7"!=e[s].questionAnswerType?"3"==e[s].questionAnswerType||"6"==e[s].questionAnswerType?r[s]=2:r[s]=2:r[s]=e[s].options.length+1;return console.log(r),splitWeight(r,e)},splitWeight=function(e,r){var s=0,n=0,t=[];for(var o in e)e[o]+n<=13?n+=e[o]:(n=0,t[s]=o,s+=1);if(0==t.length)return[r];console.log(t);var l=[];for(var a in t)0==a?l[a]=r.slice(0,t[a]):l[a]=r.slice(t[a-1],t[a]),l[t.length]=r.slice(t[t.length-1],t[t.length]);return l},takePagesNum=function(e){var r=$(".swiper-pagination");for(var s in e)r.append('<span class="swiper-pagination-bullet"></span>')};app.controller("personalCtrl",function(e,r,s,n,t,o,l){console.log("personalCtrl  p1"),$(".icon-gerenxinxi").addClass("active"),r.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50),e.setModOneQue=function(e){console.log(e)},e.alertLogin=function(){swal({title:"登录",allowOutsideClick:!1,showCloseButton:!1,animation:!1,input:"password",inputPlaceholder:"密码(6-10位)",html:'<div class="weui-cell__hd"><input type="checkbox" class="loginCheckbox" name="checkbox1" id="loginCheckbox" checked="checked"><span>记住密码自动登录</span></div><input class="swal2-input" id="teleNum" placeholder="手机号/用户名" type="text" style="display: block;" autofocus>',inputValidator:function(e){return new Promise(function(r,s){$teleNum=$("#teleNum").val(),/^1(3|4|5|7|8)\d{9}$/.test($teleNum)&&e.length>=6&&e.length<=10?r():s(/^1(3|4|5|7|8)\d{9}$/.test($teleNum)?"请正确填写密码!":"请正确填写手机号!")})},showCancelButton:!0,confirmButtonText:"登录",cancelButtonText:"去注册"}).then(function(r){allFactory.teleNum=$("#teleNum").val(),allFactory.password=r,allFactory.HASHPASSWD=l.createHash(r),s.post(allFactory.postLogin,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient",isRemember:allFactory.isRemember}).success(function(r){r.msg?(allFactory.isLogin=!0,allFactory.userId=r.userId,e.getPage(),allFactory.isRemember?window.localStorage.userInfo=JSON.stringify({teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD}):window.localStorage.clear(),swal.resetDefaults(),swal({title:"登录成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")})):swal("错误",r.errorText,"error").then(function(){e.alertLogin()})})},function(r){"cancel"===r&&e.alertRegister()})["catch"](swal.noop)},e.alertRegister=function(){swal.setDefaults({input:"text",confirmButtonText:"下一步&rarr;",allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,animation:!1,cancelButtonText:"去登录",progressSteps:["1","2","3","4"]});var r,n=[{title:"手机号码",input:"text",inputPlaceholder:"请输入您的真实手机号码",confirmButtonText:"发送验证码",inputValidator:function(e){return new Promise(function(r,s){/^1(3|4|5|7|8)\d{9}$/.test(e)?(allFactory.teleNum=e,r()):s("请输入正确的手机号")})}},{title:"验证码",input:"text",inputPlaceholder:"请填入刚刚收到的验证码"},{title:"密码",input:"password",inputPlaceholder:"密码(6-10位)",inputValidator:function(e){return new Promise(function(s,n){e.length>=6&&e.length<=10?(r=e,s()):n("请按格式正确输入密码")})}},{title:"重复输入密码",input:"password",confirmButtonText:"注册",inputPlaceholder:"重复输入密码(6-10位)",inputValidator:function(n){return new Promise(function(t,o){n.length>=6&&n.length<=10&&n==r?(allFactory.password=r,allFactory.HASHPASSWD=l.createHash(r),s.post(allFactory.postRegister,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient"}).success(function(r){r.msg?(allFactory.userId=r.userId,t(),allFactory.isLogin=!0,e.getPage()):(swal.resetDefaults(),swal("错误",r.errorText,"error").then(function(){e.alertRegister()}))})):o(n!=r?"密码输入不符":"请按格式正确输入密码")})}}];swal.queue(n).then(function(e){swal.resetDefaults(),swal({title:"注册成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")})},function(r){"cancel"===r&&(swal.resetDefaults(),e.alertLogin())})};var a=1;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModOneQue=function(r){console.log(r),e.setModOne=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modOne=sumWeight(_.flatten(r.body.questions)),e.setModOneQue(e.modOne)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("basicSituation",{})},allFactory.isLogin||window.localStorage.userInfo?(allFactory.teleNum=JSON.parse(window.localStorage.userInfo).teleNum,allFactory.HASHPASSWD=JSON.parse(window.localStorage.userInfo).HASHPASSWD,swal("已登录","账号："+allFactory.teleNum,"success"),e.getPage()):e.alertLogin()}),app.controller("basicSituationCtrl",function(e,r,s,n,t,o,l){console.log("basicSituationCtrl  p2"),$(".icon-xinyongqingkuang-copy").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=2;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModTwoQue=function(r){console.log(r),e.setModTwo=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modTwo=sumWeight(_.flatten(r.body.questions)),e.setModTwoQue(e.modTwo)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("medicalHistory",{})},e.getPage()}),app.controller("medicalHistoryCtrl",function(e,r,s,n,t,o,l){console.log("medicalHistoryCtrl  p3"),$(".icon-bingli").addClass("active"),r.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50);var a=3;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModThreeQue=function(r){console.log(r),e.setModThree=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modThree=sumWeight(_.flatten(r.body.questions)),e.setModThreeQue(e.modThree)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("habitsCustoms",{})},e.getPage()}),app.controller("habitsCustomsCtrl",function(e,r,s,n,t,o,l){console.log("habitsCustomsCtrl  p4"),$(".icon-shenghuo").addClass("active"),r.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50);var a=4;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModFourQue=function(r){console.log(r),e.setModFour=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modFour=sumWeight(_.flatten(r.body.questions)),e.setModFourQue(e.modFour)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("medication",{})},e.getPage()}),app.controller("medicationCtrl",function(e,r,s,n,t,o,l){console.log("medicationCtrl  p5"),$(".icon-yao").addClass("active"),r.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50);var a=5;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModFiveQue=function(r){console.log(r),e.setModFive=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modFive=sumWeight(_.flatten(r.body.questions)),e.setModFiveQue(e.modFive)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("breast",{})},e.getPage()}),app.controller("breastCtrl",function(e,r,s,n,t,o,l){console.log("breastCtrl  p6"),$(".icon-zhishichanquan2").addClass("active"),r.swiper=makeSwiper(),$(".swiper-slide").height($(window).height()-50);var a=6;e.userAnswer=[],e.fillBlank=function(r,s){alert("s");var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseSin=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[s],t=!0)}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.chooseDou=function(r,s){var n={UUID:r,answerId:[s]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var n=!1;_.each(e.answerId,function(r,t){r==s&&(e.answerId.splice(t,1),n=!0)}),n||e.answerId.push(s),t=!0}}),t||e.userAnswer.push(n)}else e.userAnswer.push(n);console.log(e.userAnswer)},e.setModSixQue=function(r){console.log(r),e.setModSix=r},e.getPage=function(){s.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(r){console.log(r),r.msg?(e.modSix=sumWeight(_.flatten(r.body.questions)),e.setModSixQue(e.modSix)):(swal("网络错误，请重试",r.errorText,"error"),e.alertLogin())}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){s.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,s,n){swal("网络错误","错误信息："+r,"error")})},e.finishAll=function(){swal("提交成功","","success")},e.getPage()}),app.controller("loginCtrl",function(e,r,s){console.log("222")}),app.directive("changePage",function(){return{restrict:"EA",replace:!0,template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,r){e.prev=function(){r.swiper.slidePrev()},e.next=function(){r.swiper.slideNext()}}}}),app.directive("prevMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"&infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一章</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,r,s){e.prev=function(){s.go(e.pageUrl,{})},e.next=function(){r.swiper.slideNext()}}}}),app.directive("nextMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"@infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一章</button></div>',controller:function(e,r,s){e.prev=function(){r.swiper.slidePrev()},e.next=function(){s.go(e.pageUrl,{})}}}});
//# sourceMappingURL=app.js.map
